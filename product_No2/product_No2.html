<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>product_No2</title>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <link rel="stylesheet" href="product_No2.css">
</head>

<body>
  <h1 id="Mydeck">
    <p>あなたのデッキ</p>
  </h1>

  <script type="module">

    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.13.0/firebase-app.js";

    import {
      getFirestore,
      collection,
      addDoc,
      serverTimestamp,
      onSnapshot,


      query,
      orderBy,
      limit,

      setDoc,
      updateDoc,
      doc,

    } from "https://www.gstatic.com/firebasejs/9.13.0/firebase-firestore.js";

    function arrayShuffle(array) {
      for (let i = (array.length - 1); 0 < i; i--) {

        // 0〜(i+1)の範囲で値を取得
        let r = Math.floor(Math.random() * (i + 1));

        // 要素の並び替えを実行
        let tmp = array[i];
        array[i] = array[r];
        array[r] = tmp;
      }
      return array;

    }


    const firebaseConfig = {
      apiKey: "AIzaSyCn--fY825L4EZ8GxDEhBDdQfe2DHRRZ88",
      authDomain: "productno2-987a6.firebaseapp.com",
      projectId: "productno2-987a6",
      storageBucket: "productno2-987a6.appspot.com",
      messagingSenderId: "834870957711",
      appId: "1:834870957711:web:bc702b47961429cc0a42fa"
    };

    const app = initializeApp(firebaseConfig);
    // Cloud Firestore自体？
    const db = getFirestore(app);

    // データに変更（追加，更新，削除など）が生じたタイミングで実行される onSnapshot()
    onSnapshot(collection(db, "chat"), (querySnapshot) => {
      // Firestore 上に保存されているデータは querySnapshot.docs に入っている．
      console.log(querySnapshot.docs);
      // 空の配列を準備．
      const documents = [];
      // querySnapshot.docs に対して繰り返し処理
      querySnapshot.docs.forEach(function (doc) {
        const document = {
          id: doc.id,
          data: doc.data(),
        };
        documents.push(document);
      });
      console.log(documents);
      console.log(documents[0]);
      console.log(documents[0].data);
      console.log(documents[0].data.name);
      console.log(documents[0].data.text);

      $("#Mydeck").on("click", function () {
        // alert("ok")
        //   const random_new_array = [];
        //   for(let i = 0 , len = documents.length  ;i< documents.length; i++, len--){

        //   const rndNum = Math.floor(Math.random() * documents.length);
        //   console.log(rndNum)
        //   random_new_array.push(documents[rndNum]);
        //   console.log(random_new_array);
        //   // documents[rndNum] = documents[len - 1];
        //   // console.log(len - 1)
        //   // console.log(documents[len - 1])
        // }
        arrayShuffle(documents)
        console.log(documents)





      });


    });

  </script>


</body>

</html>